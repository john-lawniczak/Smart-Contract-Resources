# Real-World Exploited Contracts & Postmortems

**Last verified: 2026-01**

This directory contains references to real-world smart contract exploits with available source code and official postmortems. All incidents are documented on [Rekt News](https://rekt.news/) with additional technical analysis.

---

## Directory Structure

```
real-world-exploits/
├── README.md (this file)
├── 2024-exploits/
├── 2023-exploits/
├── 2022-exploits/
└── historical-exploits/
```

---

## Major Exploits with Available Contracts

### 2024 Exploits

#### Orbit Bridge ($82M) - December 2024
- **Type**: Private key compromise
- **Loss**: $82M
- **Rekt Article**: [Orbit Bridge - Rekt](https://rekt.news/orbit-bridge-rekt/)
- **Root Cause**: Compromised validator keys
- **Contracts**: Bridge contracts on BSC/Ethereum
- **Key Learning**: Multi-sig security, key management

#### Radiant Capital ($50M) - October 2024
- **Type**: Compromised multisig (social engineering)
- **Loss**: $50M
- **Rekt Article**: [Radiant Capital - Rekt](https://rekt.news/radiant-capital-rekt/)
- **Root Cause**: Malware-infected developer machines signed malicious transaction
- **Postmortem**: [Official Postmortem](https://radiant.capital/blog/update-on-security-incident)
- **Contracts**: Radiant V2 lending pools on Arbitrum/BSC
- **Key Learning**: Hardware wallet security, transaction verification, social engineering defense

#### Shezmu ($4.9M) - July 2024
- **Type**: Access control failure
- **Loss**: $4.9M
- **Rekt Article**: [Shezmu - Rekt](https://rekt.news/shezmu-rekt/)
- **Root Cause**: Unprotected initialize function in proxy contract
- **Contracts**: Available on Etherscan
- **Key Learning**: Always protect initialize functions, proxy pattern security

---

### 2023 Exploits

#### Euler Finance ($197M) - March 2023
- **Type**: Donation attack + reentrancy
- **Loss**: $197M (funds returned via white-hat negotiation)
- **Rekt Article**: [Euler Finance - Rekt](https://rekt.news/euler-finance-rekt/)
- **Postmortem**: [Euler Official Report](https://www.euler.finance/blog/eulers-return)
- **Root Cause**: 
  - Donation attack to manipulate health check
  - Violated checks-effects-interactions pattern
  - Missing reentrancy guard
- **Contracts**: [Euler GitHub](https://github.com/euler-xyz/euler-contracts)
- **Exploit Analysis**: [Paradigm Analysis](https://www.paradigm.xyz/2023/03/euler-finance-exploit)
- **Key Learning**: CEI pattern, donation attack vectors, health check manipulation

#### BNB Bridge ($586M) - October 2022
- **Type**: Merkle proof forgery
- **Loss**: $586M (partially recovered)
- **Rekt Article**: [BNB Bridge - Rekt](https://rekt.news/bnb-bridge-rekt/)
- **Postmortem**: [BNB Chain Analysis](https://www.bnbchain.org/en/blog/bnb-chain-ecosystem-update/)
- **Root Cause**: Weak Merkle proof verification allowed forging withdrawal proofs
- **Contracts**: BSC Token Hub
- **Key Learning**: Proper Merkle tree validation, message authentication

#### Mango Markets ($110M) - October 2022
- **Type**: Oracle manipulation
- **Loss**: $110M
- **Rekt Article**: [Mango Markets - Rekt](https://rekt.news/mango-markets-rekt/)
- **Postmortem**: [Mango DAO Incident Report](https://docs.mango.markets/)
- **Root Cause**: 
  - Manipulated oracle price via leveraged positions
  - Low liquidity on perpetual market
  - Insufficient circuit breakers
- **Contracts**: [Mango V3 Contracts](https://github.com/blockworks-foundation/mango-v3)
- **Key Learning**: Oracle manipulation, low-liquidity market risks, price deviation limits

#### Nomad Bridge ($190M) - August 2022
- **Type**: Merkle root validation bug
- **Loss**: $190M
- **Rekt Article**: [Nomad - Rekt](https://rekt.news/nomad-rekt/)
- **Postmortem**: [Nomad Official Report](https://medium.com/nomad-xyz-blog/nomad-bridge-hack-root-cause-analysis-875ad2e5aacd)
- **Root Cause**: 
  - Initialized merkle root to 0x00
  - 0x00 treated as valid proof for any message
  - Anyone could forge withdrawal proofs
- **Contracts**: [Nomad GitHub](https://github.com/nomad-xyz/nomad-monorepo)
- **Vulnerability Code**:
```solidity
// Vulnerable initialization
bytes32 public committedRoot = 0x00; // Should not default to 0x00!

function process(bytes memory _message, bytes32[32] calldata _proof) public {
    require(MerkleLib.verify(_proof, committedRoot, messageHash), "!prove");
    // Process withdrawal...
}

// Issue: When committedRoot = 0x00, MerkleLib.verify returns true for any proof
```
- **Key Learning**: Proper initialization, never use 0x00 as valid state, test edge cases

---

### 2022 Exploits

#### Ronin Bridge ($625M) - March 2022
- **Type**: Private key compromise
- **Loss**: $625M (largest DeFi hack)
- **Rekt Article**: [Ronin - Rekt](https://rekt.news/ronin-rekt/)
- **Postmortem**: [Ronin Network Update](https://roninblockchain.substack.com/p/back-to-building)
- **Root Cause**: 
  - 5 of 9 validator keys compromised via social engineering
  - Attacker gained control of majority validator set
  - Forged withdrawal transactions
- **Contracts**: Ronin Bridge contracts (Axie Infinity side-chain)
- **Key Learning**: 
  - Threshold too low (5/9 = 55%)
  - Need geographic/organizational distribution of validators
  - Hardware security modules (HSM) for key storage
  - Separate hot/cold wallet architecture

#### Wormhole Bridge ($326M) - February 2022
- **Type**: Signature verification bypass
- **Loss**: $326M
- **Rekt Article**: [Wormhole - Rekt](https://rekt.news/wormhole-rekt/)
- **Postmortem**: [Wormhole Analysis](https://github.com/certora/publications/blob/master/reports/Wormhole/WormholeReport.pdf)
- **Root Cause**: 
  - Guardian signature verification bypassed
  - Attacker could mint tokens without burning on source chain
  - Solana-specific vulnerability in instruction verification
- **Contracts**: [Wormhole GitHub](https://github.com/wormhole-foundation/wormhole)
- **Vulnerability**:
```rust
// Vulnerable Solana instruction handler
// Missing check for account owner
if instruction.data.len() < GUARDIAN_SET_INDEX_LEN {
    return Err(ProgramError::InvalidInstructionData);
}

// Attacker bypassed guardian signature verification
// by providing fake guardian set account
```
- **Key Learning**: Strict account ownership verification on Solana, validate all instruction parameters

#### Poly Network ($611M) - August 2021
- **Type**: Access control failure
- **Loss**: $611M (funds returned by white-hat)
- **Rekt Article**: [Poly Network - Rekt](https://rekt.news/polynetwork-rekt/)
- **Postmortem**: [Poly Network Analysis](https://www.certik.com/resources/blog/3K7ZUAKpOr1GW75J2i0VHh-poly-network-hack-explained)
- **Root Cause**: 
  - Missing access control on critical function
  - `EthCrossChainManager` allowed anyone to call privileged function
  - Attacker changed contract ownership via cross-chain message
- **Contracts**: [Poly Network Contracts](https://github.com/polynetwork/eth-contracts)
- **Vulnerability**:
```solidity
// Vulnerable function - missing access control!
function putCurEpochConPubKeyBytes(bytes memory curEpochPkBytes) public {
    ConKeepersPkBytes = curEpochPkBytes;
    // No require(msg.sender == owner) or similar!
}

// Attacker called this function via cross-chain message
// Changed keeper public keys to attacker-controlled keys
// Used new keys to authorize malicious withdrawals
```
- **Key Learning**: 
  - Always use access control modifiers on privileged functions
  - Review all cross-chain message handlers
  - Defense in depth - multiple layers of authorization

---

### Historical Exploits (2016-2021)

#### Cream Finance ($130M) - October 2021
- **Type**: Reentrancy + flash loan
- **Loss**: $130M
- **Rekt Article**: [Cream Finance - Rekt](https://rekt.news/cream-rekt-2/)
- **Postmortem**: [PeckShield Analysis](https://twitter.com/peckshield/status/1453364046904786950)
- **Root Cause**: 
  - ERC-777 token with hooks enabled reentrancy
  - Flash loan amplified the attack
  - Cross-function reentrancy in lending protocol
- **Contracts**: Cream Finance forks Compound V2
- **Key Learning**: Beware of tokens with hooks (ERC-777, ERC-1155), reentrancy guards on all state-changing functions

#### BadgerDAO ($120M) - December 2021
- **Type**: Frontend compromise
- **Loss**: $120M
- **Rekt Article**: [Badger - Rekt](https://rekt.news/badger-rekt/)
- **Postmortem**: [Badger Official Report](https://badger.com/technical-post-mortem)
- **Root Cause**: 
  - Compromised Cloudflare API key
  - Malicious script injected into frontend
  - Users approved unlimited token allowances to attacker
- **Key Learning**: 
  - Frontend security is critical
  - Verify transaction data before signing
  - Limit token approvals
  - Use hardware wallets

#### Yearn Finance yDAI Vault ($11M) - February 2021
- **Type**: Economic attack (flash loan + strategy manipulation)
- **Loss**: $11M
- **Rekt Article**: [Yearn Finance - Rekt](https://rekt.news/yearn-rekt/)
- **Postmortem**: [Yearn Official Analysis](https://github.com/yearn/yearn-security/blob/master/disclosures/2021-02-04.md)
- **Root Cause**: 
  - Flash loan used to manipulate price in yDAI vault strategy
  - Strategy used spot price from Curve pool without TWAP
  - Attacker borrowed, manipulated price, profited from mispriced assets
- **Contracts**: [Yearn V1 Vaults](https://github.com/yearn/yearn-protocol)
- **Vulnerability Flow**:
```
1. Flash loan large amount of DAI
2. Deposit into Curve pool to manipulate price
3. Trigger yDAI vault strategy rebalance (reads manipulated price)
4. Vault sells assets at manipulated price
5. Attacker buys underpriced assets
6. Return flash loan, keep profit
```
- **Fix**: 
  - Use TWAP oracles instead of spot prices
  - Implement deposit/withdrawal fees to make flash loan attacks unprofitable
  - Add slippage protection on strategy trades
- **Key Learning**: Never use spot prices for critical decisions, implement economic attack resistance

#### The DAO ($60M) - June 2016
- **Type**: Reentrancy
- **Loss**: $60M (15% of all ETH at the time)
- **Impact**: Led to Ethereum hard fork (ETH/ETC split)
- **Postmortem**: [Analysis by Phil Daian](https://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/)
- **Root Cause**: 
  - Classic reentrancy vulnerability
  - Attacker recursively called withdrawal function before balance updated
- **Vulnerable Code**:
```solidity
function withdraw(uint amount) {
    if (balances[msg.sender] >= amount) {
        // External call BEFORE state update (vulnerable!)
        msg.sender.call.value(amount)();
        
        // State update happens too late
        balances[msg.sender] -= amount;
    }
}

// Attacker's fallback function
fallback() payable {
    // Reenter withdraw() before balance updated
    target.withdraw(amount);
}
```
- **Fix**: Follow Checks-Effects-Interactions (CEI) pattern:
```solidity
function withdraw(uint amount) {
    // Checks
    require(balances[msg.sender] >= amount);
    
    // Effects (update state FIRST)
    balances[msg.sender] -= amount;
    
    // Interactions (external call LAST)
    (bool success,) = msg.sender.call{value: amount}("");
    require(success);
}
```
- **Key Learning**: 
  - Always follow CEI pattern
  - Update state before external calls
  - Use reentrancy guards
  - Most important vulnerability in Solidity history

---

## Common Vulnerability Patterns

### By Category

**Oracle Manipulation**:
- Mango Markets, Yearn Finance, Cream Finance
- **Prevention**: TWAP oracles, circuit breakers, multiple oracle sources

**Reentrancy**:
- The DAO, Cream Finance, various others
- **Prevention**: CEI pattern, reentrancy guards, pull over push

**Access Control**:
- Poly Network, Shezmu, various proxy exploits
- **Prevention**: OpenZeppelin AccessControl, test all privileged functions

**Bridge Vulnerabilities**:
- Ronin, Wormhole, Nomad, BNB Bridge, Orbit Bridge
- **Prevention**: Multi-sig diversity, threshold signatures, proper validation

**Flash Loans**:
- Yearn, Cream, numerous others
- **Prevention**: Economic attack resistance, TWAPs, deposit delays

**Frontend Compromise**:
- BadgerDAO
- **Prevention**: Transaction verification, limited approvals, hardware wallets

---

## Analysis Tools

### Helpful Resources for Exploit Analysis

**Block Explorers with Contract Verification**:
- [Etherscan](https://etherscan.io/)
- [Arbiscan](https://arbiscan.io/)
- [BscScan](https://bscscan.com/)

**Transaction Debugging**:
- [Tenderly](https://tenderly.co/)
- [Phalcon by BlockSec](https://phalcon.blocksec.com/)
- [Sentio Debugger](https://app.sentio.xyz/)
- [Openchain Transaction Viewer](https://openchain.xyz/)

**Exploit Databases**:
- [Rekt News](https://rekt.news/) - Exploit write-ups and leaderboard
- [DeFiLlama Hacks](https://defillama.com/hacks) - Comprehensive database
- [BlockSec Attack Database](https://github.com/Autosaida/DeFiHackLabs)

**Smart Contract Analysis**:
- [Etherscan Contract Reader](https://etherscan.io/find-similar-contracts)
- [Contract Diff Checker](https://www.diffchecker.com/solidity/)
- [Dedaub Contract Library](https://library.dedaub.com/)

---

## Learning Resources

### Exploit Simulation & Practice

**Damn Vulnerable DeFi**:
- Challenges based on real exploits
- Located in `../damn-vulnerable-defi-foundry/`
- Practice environment for security testing

**Capture The Flag (CTF) Platforms**:
- [Ethernaut](https://ethernaut.openzeppelin.com/) - OpenZeppelin CTF
- [Paradigm CTF](https://ctf.paradigm.xyz/) - Annual competition
- [Capture the Ether](https://capturetheether.com/) - Classic challenges

### Security Auditing

**Audit Reports**:
- [Code4rena Findings](https://code4rena.com/reports)
- [Spearbit Portfolio](https://github.com/spearbit/portfolio)
- [Trail of Bits Publications](https://github.com/trailofbits/publications)

---

## Contributing

To add a new exploit reference:
1. Must have official postmortem or detailed analysis
2. Contracts should be verified on block explorer
3. Include Rekt News article link
4. Provide vulnerability details and key learnings
5. Add to appropriate year directory

---

[← Back to Main](../../README.md)
